!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SoundCloudAudio=t()}}(function(){return function r(n,a,l){function u(e,t){if(!a[e]){if(!n[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(p)return p(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var s=a[e]={exports:{}};n[e][0].call(s.exports,function(t){return u(n[e][1][t]||t)},s,s.exports,r,n,a,l)}return a[e].exports}for(var p="function"==typeof require&&require,t=0;t<l.length;t++)u(l[t]);return u}({1:[function(t,e,i){"use strict";var r,o="https://api.soundcloud.com",n="protocol hostname host pathname port search hash href".split(" ");function u(t){r||(r=document.createElement("a"));var e={};r.href=t||"";for(var i=0,o=n.length;i<o;i++){var s=n[i];e[s]=r[s]}return e}function s(t,e){if(!(this instanceof s))return new s(t,e);this._events={},this._oauthToken=t,this._baseUrl=e||o,this.playing=!1,this.duration=0,this.audio=document.createElement("audio")}s.prototype.resolve=function(i,o){var t=this._baseUrl+"/resolve.json?url="+encodeURIComponent(i);this._json(t,function(t){if(this.cleanData(),Array.isArray(t)&&(t={tracks:t}),t.tracks)t.tracks=t.tracks.map(this._transformTrack.bind(this)),this._playlist=t;else{this._track=this._transformTrack(t);var e=u(i);this._track.stream_url+=e.hash}this.duration=t.duration&&!isNaN(t.duration)?t.duration/1e3:0,o(t)}.bind(this))},s.prototype._jsonp=function(t,e){var i,o,s,r,n=document.getElementsByTagName("script")[0]||document.head,a=document.createElement("script"),l="jsonp_callback_"+(new Date).valueOf()+Math.floor(1e3*Math.random());window[l]=function(t){a.parentNode&&a.parentNode.removeChild(a),window[l]=function(){},e(t)},a.src=(i="callback",o=l,s=u(t),r=/\?(?:.*)$/.test(s.search)?"&":"?",s.protocol+"//"+s.host+s.port+s.pathname+s.search+r+i+"="+o+s.hash),n.parentNode.insertBefore(a,n)},s.prototype._json=function(e,i,o){o=o||function(){};var s=new XMLHttpRequest;s.open("GET",e),s.setRequestHeader("Authorization","OAuth "+this._oauthToken),s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){var t={};try{t=JSON.parse(s.responseText)}catch(t){o("Could not parse JSON response: "+t.message)}i(t)}else o('URL "'+e+'" could not be loaded with HTTP code '+s.status)},s.send(null)},s.prototype._transformTrack=function(t){return this._baseUrl!==o&&(t.original_stream_url=t.stream_url,t.stream_url=t.stream_url.replace(o,this._baseUrl)),t},s.prototype.on=function(t,e){this._events[t]=e,this.audio.addEventListener(t,e,!1)},s.prototype.off=function(t,e){this._events[t]=null,this.audio.removeEventListener(t,e)},s.prototype.unbindAll=function(){for(var t in this._events){var e=this._events[t];e&&this.off(t,e)}},s.prototype.preload=function(t,e){this._track={stream_url:t},e&&(this.audio.preload=e),this.audio.src=t},s.prototype._play=function(t){return t!==this.audio.src&&(this.audio.src=t),this.playing=t,this.audio.play()},s.prototype._playTrack=function(t){var e=this;this._json(this._baseUrl+"/tracks/"+t.id+"/streams",function(t){e._play(t.http_mp3_128_url)},function(t){e.stop(),console.error(t)})},s.prototype.play=function(t){if((t=t||{}).streamUrl)this._play(t.streamUrl);else if(this._playlist){var e=this._playlist.tracks.length;if(e){if(void 0===t.playlistIndex?this._playlistIndex=this._playlistIndex||0:this._playlistIndex=t.playlistIndex,this._playlistIndex>=e||this._playlistIndex<0)return void(this._playlistIndex=0);this._playTrack(this._playlist.tracks[this._playlistIndex])}}else this._track&&this._playTrack(this._track)},s.prototype.pause=function(){this.audio.pause(),this.playing=!1},s.prototype.stop=function(){this.audio.pause(),this.audio.currentTime=0,this.playing=!1},s.prototype.next=function(t){t=t||{};var e=this._playlist.tracks.length;if(this._playlistIndex>=e-1){if(!t.loop)return;this._playlistIndex=-1}if(this._playlist&&e)return this.play({playlistIndex:++this._playlistIndex})},s.prototype.previous=function(){if(!(this._playlistIndex<=0))return this._playlist&&this._playlist.tracks.length?this.play({playlistIndex:--this._playlistIndex}):void 0},s.prototype.seek=function(t){if(!this.audio.readyState)return!1;var e=t.offsetX/t.target.offsetWidth||(t.layerX-t.target.offsetLeft)/t.target.offsetWidth;this.audio.currentTime=e*(this.audio.duration||0)},s.prototype.cleanData=function(){this._track=void 0,this._playlist=void 0},s.prototype.setVolume=function(t){this.audio.readyState&&(this.audio.volume=t)},s.prototype.setTime=function(t){this.audio.readyState&&(this.audio.currentTime=t)},e.exports=s},{}]},{},[1])(1)});
